<div class="p-6 bg-white rounded-xl shadow-md mt-6">
  <div class="flex justify-between items-center mb-4">
    <h2 class="text-lg text-[#1E293B] font-bold">Lista de usuarios</h2>
    <div class="flex items-center gap-4">
      <div class="relative">
        <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
          <i class="pi pi-search text-gray-400"></i>
        </div>
        <input
          type="text"
          placeholder="Buscar usuario"
          [(ngModel)]="searchValue"
          class="border border-gray-300 text-[#64748B] rounded-lg px-3 py-2 pl-10 focus:outline-none focus:ring-2 focus:ring-blue-500 w-full"
        />
      </div>
    </div>
  </div>

  <p-table
    [value]="usuarios"
    [paginator]="true"
    [rows]="5"
    [globalFilterFields]="['nombre', 'apellido', 'dni', 'email', 'rol']"
    [rowsPerPageOptions]="[5, 10, 20]"
    [filterDelay]="0"
    [filters]="{ global: { value: searchValue, matchMode: 'contains' } }"
    class="shadow rounded-xl overflow-hidden"
    >
    <ng-template pTemplate="header">
      <tr class="bg-gray-50">
        <th pSortableColumn="name" class="!text-black">
          Nombre <p-sortIcon field="nombre"></p-sortIcon>
        </th>
        <th pSortableColumn="lastname" class="!text-black">
          Apellido <p-sortIcon field="apellido"></p-sortIcon>
        </th>
          <th pSortableColumn="email" class="!text-black">
              Correo electr√≥nico <p-sortIcon field="email" ></p-sortIcon>
          </th>
        <th pSortableColumn="nationalId" class="!text-black">DNI <p-sortIcon field="dni"></p-sortIcon></th>
        <th pSortableColumn="role" class="!text-black">Rol  <p-sortIcon field="rol"></p-sortIcon></th>
        <th style="width: 40px"></th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-user>
      <tr class="hover:bg-gray-100">
        <td class="text-gray-600">{{ user.name }}</td>
        <td class="text-gray-600">{{ user.lastname }}</td>
        <td class="text-gray-600">{{ user.email }}</td>
        <td class="text-gray-600">{{ user.nationalId}}</td>
        <td>
          <span
            class="px-3 py-1 rounded-full text-xs font-semibold"
            [ngClass]="{
              'bg-blue-200 text-blue-800': user.role === 'Administrador',
              'bg-green-200 text-green-800': user.role === 'Laboratorio',
              'bg-pink-200 text-pink-800': user.role === 'Sucursal'
            }"
          >
            {{ user.role }}
          </span>
        </td>
        <td>

          <ng-template pTemplate="paginatorleft">
          <div class="flex-1"></div>
          </ng-template>
          <p-menu
     #menu
     [popup]="true"
     [model]="getRowMenuItems(usuarios)"
     [appendTo]="'body'"
    ></p-menu>

    <button
     pButton
     type="button"
     icon="pi pi-ellipsis-v"
     class="p-button-text p-button-rounded"
     (click)="onMenuButtonClick($event, menu)"
     ></button>

    <ng-template pTemplate="paginatorright">
      <button
        pButton
        type="button"
        label="Registrar usuario"
        icon="pi pi-user-plus"
        (click)="goToRegister()"
        class="p-button-raised p-button-secondary px-6 py-2 font-semibold text-base ml-4"
      ></button>
    </ng-template>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>
